#!/usr/bin/env bash
set -e

# Find webview_devtools_remote socket dynamically
SOCKET=$(adb shell "cat /proc/net/unix | grep webview_devtools_remote | tail -n 1" | awk '{print $8}' | tr -d '@')

if [[ -z "$SOCKET" ]]; then
  echo "[error] No active WebView devtools socket found."
  exit 1
fi

echo "[info] Found WebView socket: $SOCKET"

# Forward port
adb forward tcp:9222 localabstract:$SOCKET 2>/dev/null
echo "[success] Port 9222 forwarded to $SOCKET"

# Fetch DevTools target list
curl -s http://localhost:9222/json/list || {
  echo "[error] Could not fetch DevTools list. Check if WebView debugging is enabled."
  exit 1
}






# --- íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €(ì„œë¹„ìŠ¤ 'package') ì¤€ë¹„ ëŒ€ê¸° ìœ í‹¸ ---
wait_for_package_manager() {
  local serial="$1"
  echo "[*] íŒ¨í‚¤ì§€ ë§¤ë‹ˆì € ê¸°ë™ ëŒ€ê¸° ì¤‘..."

  # 1) ë¶€íŒ… ì• ë‹ˆë©”ì´ì…˜ ì¢…ë£Œ ëŒ€ê¸°(ê°€ëŠ¥í•œ ê²½ìš°)
  for _ in {1..60}; do
    state="$(adb -s "$serial" shell getprop init.svc.bootanim 2>/dev/null | tr -d '\r')"
    [[ "$state" == "stopped" || "$state" == "" ]] && break
    sleep 1
  done

  # 2) zygoteê°€ ë–  ìžˆëŠ”ì§€ í™•ì¸ (64/32 ë‘˜ ë‹¤ ì²´í¬)
  for _ in {1..60}; do
    if adb -s "$serial" shell 'pidof zygote || pidof zygote64' >/dev/null 2>&1; then
      break
    fi
    sleep 1
  done

  # 3) íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €ê°€ ì‹¤ì œë¡œ ì‘ë‹µí•˜ëŠ”ì§€ í™•ì¸
  #    - ê°€ìž¥ ì‹ ë¢°ë„ ë†’ì€ ì²´í¬: pm path android / pm list packages
  for i in {1..90}; do
    if adb -s "$serial" shell 'pm path android' >/dev/null 2>&1; then
      echo "[*] íŒ¨í‚¤ì§€ ë§¤ë‹ˆì € ì‘ë‹µ í™•ì¸ ì™„ë£Œ"
      return 0
    fi
    # ë³´ì¡° í™•ì¸: binder ì„œë¹„ìŠ¤ í…Œì´ë¸”ì— 'package'ê°€ ëœ¨ëŠ”ì§€
    if adb -s "$serial" shell 'cmd -l | grep -q "^package$"' >/dev/null 2>&1; then
      echo "[*] cmd ì„œë¹„ìŠ¤ ëª©ë¡ì— package í™•ì¸"
      return 0
    fi
    sleep 2
  done

  echo "[!] ì¼ì • ì‹œê°„ ë‚´ íŒ¨í‚¤ì§€ ë§¤ë‹ˆì € ì¤€ë¹„ê°€ ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤." >&2
  return 1
}







### === (ë¶™ì—¬ë„£ê¸°) APK ì„¤ì¹˜ ë° ì‹¤í–‰ ì„¹ì…˜ ===
set -euo pipefail

# (í•„ìš” ì‹œ ì»¤ìŠ¤í„°ë§ˆì´ì¦ˆ)
APK_NAME="${APK_NAME:-app-debug.apk}"

# í˜„ìž¬ ìŠ¤í¬ë¦½íŠ¸ ê²½ë¡œ ê¸°ì¤€ APK ì°¾ê¸°
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
APK_PATH="$SCRIPT_DIR/$APK_NAME"
if [[ ! -f "$APK_PATH" ]]; then
  echo "[!] APK íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: $APK_PATH" >&2
  exit 1
fi

# ì‚¬ìš© ê°€ëŠ¥í•œ adb ì°¾ê¸° (PATHì— platform-toolsê°€ ìžˆì–´ì•¼ í•¨)
if ! command -v adb >/dev/null 2>&1; then
  echo "[!] adbë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ANDROID_SDK_ROOT/platform-toolsê°€ PATHì— ìžˆì–´ì•¼ í•©ë‹ˆë‹¤." >&2
  exit 1
fi

# ì´ë¯¸ ì‹¤í–‰ ì¤‘ì¸ ì—ë®¬ë ˆì´í„° serial ì„ íƒ
# - ê¸°ì¡´ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ EMULATOR_SERIAL/ANDROID_SERIALì„ ì…‹ì—…í–ˆë‹¤ë©´ ê·¸ ê°’ì„ ìš°ì„  ì‚¬ìš©
SERIAL_CANDIDATE_1="${EMULATOR_SERIAL:-}"
SERIAL_CANDIDATE_2="${ANDROID_SERIAL:-}"
SERIAL_CANDIDATE_3="$(adb devices | awk '/^emulator-/{print $1; exit}' || true)"
SERIAL="${SERIAL_CANDIDATE_1:-${SERIAL_CANDIDATE_2:-$SERIAL_CANDIDATE_3}}"

if [[ -z "$SERIAL" ]]; then
  echo "[!] ì‹¤í–‰ ì¤‘ì¸ ì—ë®¬ë ˆì´í„°ë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì—ë®¬ë ˆì´í„°ë¥¼ ë¨¼ì € ì‹¤í–‰/ë¶€íŒ…í•´ ì£¼ì„¸ìš”." >&2
  exit 1
fi

echo "[*] ëŒ€ìƒ ë””ë°”ì´ìŠ¤: $SERIAL"
adb -s "$SERIAL" wait-for-device

# ë¶€íŒ… ì™„ë£Œ ì‹ í˜¸ê°€ í•„ìš”í•˜ë©´ ì£¼ì„ í•´ì œ
# for _ in {1..120}; do
#   bc="$(adb -s "$SERIAL" shell getprop sys.boot_completed 2>/dev/null | tr -d '\r')"
#   [[ "$bc" == "1" ]] && break
#   sleep 2
# done

echo "[*] APK ì„¤ì¹˜ ì¤‘: $APK_PATH"
set +e
adb -s "$SERIAL" install -r -t -d "$APK_PATH"
INSTALL_RC=$?
set -e

if [[ $INSTALL_RC -ne 0 ]]; then
  echo "[!] ì„¤ì¹˜ ì‹¤íŒ¨. íŒ¨í‚¤ì§€ ì œê±° í›„ ìž¬ì‹œë„í•©ë‹ˆë‹¤..."
  # íŒ¨í‚¤ì§€ëª… ì¶”ì¶œ(apkanalyzer ë˜ëŠ” aaptê°€ ìžˆìœ¼ë©´ ì •í™•)
  PKG=""
  if command -v apkanalyzer >/dev/null 2>&1; then
    PKG="$(apkanalyzer manifest application-id "$APK_PATH" 2>/dev/null || true)"
  fi
  if [[ -z "$PKG" ]] && command -v aapt >/dev/null 2>&1; then
    PKG="$(aapt dump badging "$APK_PATH" 2>/dev/null | awk -F"'" '/package: name=/{print $2}' || true)"
  fi
  # ë‘˜ ë‹¤ ì—†ìœ¼ë©´, ì„¤ì¹˜ ì‹¤íŒ¨í–ˆìœ¼ë‹ˆ ì œê±° ìƒëžµ (íŒ¨í‚¤ì§€ëª… ëª¨ë¦„)
  if [[ -n "$PKG" ]]; then
    adb -s "$SERIAL" uninstall "$PKG" >/dev/null 2>&1 || true
  fi
  adb -s "$SERIAL" install -r -t -d "$APK_PATH"
fi

# ì‹¤í–‰: ëŸ°ì²˜ ì•¡í‹°ë¹„í‹° ìžˆìœ¼ë©´ ì§ì ‘ ì‹¤í–‰, ì•„ë‹ˆë©´ monkeyë¡œ ëŸ°ì²˜ í˜¸ì¶œ
PKG=""
LAUNCHABLE=""
if command -v apkanalyzer >/dev/null 2>&1; then
  PKG="$(apkanalyzer manifest application-id "$APK_PATH" 2>/dev/null || true)"
fi
if [[ -z "$PKG" ]] && command -v aapt >/dev/null 2>&1; then
  PKG="$(aapt dump badging "$APK_PATH" 2>/dev/null | awk -F"'" '/package: name=/{print $2}' || true)"
  LAUNCHABLE="$(aapt dump badging "$APK_PATH" 2>/dev/null | awk -F"'" '/launchable-activity: name=/{print $2}' || true)"
fi

echo "[*] ì•± ì‹¤í–‰ ì¤‘..."
if [[ -n "$PKG" && -n "$LAUNCHABLE" ]]; then
  adb -s "$SERIAL" shell am start -n "$PKG/$LAUNCHABLE" >/dev/null
elif [[ -n "$PKG" ]]; then
  adb -s "$SERIAL" shell monkey -p "$PKG" -c android.intent.category.LAUNCHER 1 >/dev/null
else
  echo "[!] íŒ¨í‚¤ì§€ëª…ì„ ì•Œ ìˆ˜ ì—†ì–´ monkey ì‹¤í–‰ ë¶ˆê°€. ì•± ì„œëžì—ì„œ ìˆ˜ë™ ì‹¤í–‰í•˜ê±°ë‚˜ 'aapt' ë˜ëŠ” 'apkanalyzer' ì„¤ì¹˜ í›„ ìž¬ì‹œë„í•˜ì„¸ìš”." >&2
  exit 1
fi

echo "[âœ”] ì™„ë£Œ: $SERIAL ì—ì„œ $APK_NAME ì‹¤í–‰"
### === (ë) APK ì„¤ì¹˜ ë° ì‹¤í–‰ ì„¹ì…˜ ===











#!/usr/bin/env bash
set -e

echo "=== OpenJDK 17 Auto Installer ==="

# ----- Detect OS -----
OS="$(uname -s)"
echo "[INFO] Detected OS: $OS"

# ----- Detect architecture -----
ARCH="$(uname -m)"
case "$ARCH" in
  x86_64|amd64) ARCH_TAG="x64" ;;
  arm64|aarch64) ARCH_TAG="aarch64" ;;
  *) echo "[ERROR] Unsupported architecture: $ARCH"; exit 1 ;;
esac

# ----- Install based on platform -----
case "$OS" in
  Linux*)
    if command -v apt >/dev/null 2>&1; then
      echo "[INFO] Installing OpenJDK 17 using apt..."
      sudo apt update -y
      sudo apt install -y openjdk-17-jdk
    elif command -v dnf >/dev/null 2>&1; then
      echo "[INFO] Installing OpenJDK 17 using dnf..."
      sudo dnf install -y java-17-openjdk
    elif command -v yum >/dev/null 2>&1; then
      echo "[INFO] Installing OpenJDK 17 using yum..."
      sudo yum install -y java-17-openjdk
    else
      echo "[ERROR] No supported package manager found. Please install manually."
      exit 1
    fi
    ;;

  Darwin*)
    if command -v brew >/dev/null 2>&1; then
      echo "[INFO] Installing OpenJDK 17 using Homebrew..."
      brew install openjdk@17
      sudo ln -sfn "$(brew --prefix)/opt/openjdk@17/libexec/openjdk.jdk" /Library/Java/JavaVirtualMachines/openjdk-17.jdk
    else
      echo "[ERROR] Homebrew not found. Please install it from https://brew.sh"
      exit 1
    fi
    ;;

  MINGW*|MSYS*|CYGWIN*)
    # ----- Windows (Git Bash or MSYS2) -----
    echo "[INFO] Installing OpenJDK 17 for Windows..."

    BASE_DIR="$HOME/AndroidEnv"
    JDK_DIR="$BASE_DIR/jdk-17"
    ZIP_PATH="$BASE_DIR/jdk.zip"
    URL="https://aka.ms/download-jdk/microsoft-jdk-17.0.11-windows-${ARCH_TAG}.zip"

    mkdir -p "$BASE_DIR"
    echo "[INFO] Downloading from $URL..."
    curl -L "$URL" -o "$ZIP_PATH"

    echo "[INFO] Extracting..."
    unzip -q "$ZIP_PATH" -d "$BASE_DIR"
    rm -f "$ZIP_PATH"

    # Auto-rename extracted folder (jdk-17.* â†’ jdk-17)
    EXTRACTED_DIR=$(find "$BASE_DIR" -maxdepth 1 -type d -name "jdk-17*" | head -n 1)
    if [ "$EXTRACTED_DIR" != "$JDK_DIR" ]; then
      mv "$EXTRACTED_DIR" "$JDK_DIR"
    fi

    echo "[INFO] Setting JAVA_HOME and PATH..."
    export JAVA_HOME="$JDK_DIR"
    export PATH="$JAVA_HOME/bin:$PATH"

    # Optional: persist environment variables
    if [[ "$SHELL" == *"bash"* ]]; then
      PROFILE="$HOME/.bashrc"
    else
      PROFILE="$HOME/.profile"
    fi

    {
      echo ""
      echo "# OpenJDK 17"
      echo "export JAVA_HOME=\"$JAVA_HOME\""
      echo "export PATH=\"\$JAVA_HOME/bin:\$PATH\""
    } >> "$PROFILE"

    echo "[SUCCESS] JDK installed to $JAVA_HOME"
    echo "[INFO] Restart your terminal or run: source $PROFILE"
    ;;

  *)
    echo "[ERROR] Unsupported OS: $OS"
    exit 1
    ;;
esac

# ----- Verify -----
echo
echo "[INFO] Checking java version..."
java -version || echo "[WARN] Java command not found in PATH."

echo
echo "[DONE] OpenJDK 17 installation completed successfully."






#!/usr/bin/env pwsh
Set-StrictMode -Version Latest
$ErrorActionPreference = "Stop"

# ====== 0. Admin privilege check ======
if (-not ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {
    Write-Host "âš ï¸  Please re-run PowerShell as Administrator."
    exit 1
}

# ====== 1. Paths ======
$BaseDir    = "$env:USERPROFILE\AndroidEnv"
$SdkRoot    = "$BaseDir\sdk"
$ToolsDir   = "$SdkRoot\cmdline-tools\latest"
$JavaDir    = "$BaseDir\jdk-17"
$ProfileDir = "$PSScriptRoot\profiles"
$ProfileFile= Join-Path $ProfileDir "note20.ini"
$AVD_DIR    = "$env:USERPROFILE\.android\avd"
$AVD_NAME   = "Galaxy_Note20_256GB"
$AVD_PATH   = "$AVD_DIR\$AVD_NAME.avd"
$AVD_CONFIG = "$AVD_PATH\config.ini"

New-Item -ItemType Directory -Force -Path $BaseDir | Out-Null

# ====== 2. Install Microsoft OpenJDK 17 ======
if (!(Test-Path "$JavaDir\bin\java.exe")) {
    Write-Host "[INFO] Installing Microsoft OpenJDK 17..."
    $jdkUrl  = "https://aka.ms/download-jdk/microsoft-jdk-17.0.11-windows-x64.zip"
    $zipPath = "$env:TEMP\jdk.zip"
    Invoke-WebRequest -Uri $jdkUrl -OutFile $zipPath -UseBasicParsing

    Expand-Archive -Force $zipPath -DestinationPath $BaseDir
    Remove-Item $zipPath -Force

    # Detect versioned folder automatically and rename to jdk-17
    $extracted = Get-ChildItem -Directory $BaseDir | Where-Object { $_.Name -like "jdk-17*" } | Select-Object -First 1
    if ($extracted -and $extracted.Name -ne "jdk-17") {
        Rename-Item -Path $extracted.FullName -NewName "jdk-17" -Force
    }
}

if (!(Test-Path "$JavaDir\bin\java.exe")) {
    Write-Host "âŒ JDK installation failed. Verify path: $JavaDir"
    exit 1
}

$env:JAVA_HOME = $JavaDir
[Environment]::SetEnvironmentVariable("JAVA_HOME", $JavaDir, "Machine")
$env:Path += ";$JavaDir\bin"

# ====== 3. Install Android Command-line Tools ======
if (!(Test-Path "$ToolsDir\bin\sdkmanager.bat")) {
    Write-Host "[INFO] Installing Android Command-line Tools..."
    $sdkUrl  = "https://dl.google.com/android/repository/commandlinetools-win-11076708_latest.zip"
    $zipSdk  = "$env:TEMP\cmdtools.zip"
    Invoke-WebRequest -Uri $sdkUrl -OutFile $zipSdk -UseBasicParsing

    Expand-Archive -Force $zipSdk -DestinationPath "$SdkRoot\cmdline-tools"
    Rename-Item -Path "$SdkRoot\cmdline-tools\cmdline-tools" -NewName "latest"
    Remove-Item $zipSdk -Force
}

$env:ANDROID_SDK_ROOT = $SdkRoot
[Environment]::SetEnvironmentVariable("ANDROID_SDK_ROOT", $SdkRoot, "Machine")
$SdkBin      = "$ToolsDir\bin"
$EmulatorExe = "$SdkRoot\emulator\emulator.exe"
$AvdManager  = "$SdkBin\avdmanager.bat"

# ====== 4. Install SDK components ======
Write-Host "[INFO] Installing SDK components..."
& "$SdkBin\sdkmanager.bat" --sdk_root="$SdkRoot" --install "platform-tools" "emulator" | Out-Null

# ====== 5. Install system image ======
$API = 30
$IMG = "system-images;android-$API;google_apis_playstore;x86_64"
Write-Host "[INFO] Installing system image: $IMG"
& "$SdkBin\sdkmanager.bat" --sdk_root="$SdkRoot" --install "$IMG" | Out-Null

# ====== 6. Create AVD ======
if (!(Test-Path $AVD_PATH)) {
    Write-Host "[INFO] Creating AVD: $AVD_NAME"
    & $AvdManager create avd -n $AVD_NAME -k $IMG --device "pixel" --force | Out-Null
    Start-Sleep -Seconds 5
} else {
    Write-Host "[INFO] Existing AVD found: $AVD_NAME"
}

# Verify that config.ini exists
if (!(Test-Path $AVD_CONFIG)) {
    Write-Host "âŒ AVD creation failed or config.ini not found."
    Write-Host "   Check: $AVD_PATH"
    exit 1
}

# ====== 7. Apply hardware profile ======
if (Test-Path $ProfileFile) {
    Write-Host "[INFO] Applying hardware profile from $ProfileFile"
    Get-Content $ProfileFile | Add-Content $AVD_CONFIG
} else {
    Write-Host "âš ï¸  Hardware profile not found. Proceeding with default configuration."
}

# ====== 8. Launch emulator ======
if (!(Test-Path $EmulatorExe)) {
    Write-Host "âŒ emulator.exe not found. Verify SDK installation: $EmulatorExe"
    exit 1
}

Write-Host "[INFO] Launching emulator..."
Start-Process "$EmulatorExe" -ArgumentList "-avd", "$AVD_NAME", "-netdelay", "none", "-netspeed", "full", "-gpu", "host"
Write-Host "[SUCCESS] Emulator launched successfully ðŸš€"






#!/usr/bin/env pwsh
Set-StrictMode -Version Latest
$ErrorActionPreference = "Stop"

# ====== 0. ê´€ë¦¬ìž ê¶Œí•œ í™•ì¸ ======
if (-not ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {
    Write-Host "âš ï¸  ê´€ë¦¬ìž ê¶Œí•œìœ¼ë¡œ PowerShellì„ ë‹¤ì‹œ ì‹¤í–‰í•´ì£¼ì„¸ìš”."
    exit 1
}

# ====== 1. ê²½ë¡œ ì„¤ì • ======
$BaseDir    = "$env:USERPROFILE\AndroidEnv"
$SdkRoot    = "$BaseDir\sdk"
$ToolsDir   = "$SdkRoot\cmdline-tools\latest"
$JavaDir    = "$BaseDir\jdk-17"
$ProfileDir = "$PSScriptRoot\profiles"
$ProfileFile= Join-Path $ProfileDir "note20.ini"
$AVD_DIR    = "$env:USERPROFILE\.android\avd"
$AVD_NAME   = "Galaxy_Note20_256GB"
$AVD_PATH   = "$AVD_DIR\$AVD_NAME.avd"
$AVD_CONFIG = "$AVD_PATH\config.ini"

# ë””ë ‰í† ë¦¬ ìƒì„±
New-Item -ItemType Directory -Force -Path $BaseDir | Out-Null

# ====== 2. JDK ì„¤ì¹˜ ======
if (!(Test-Path "$JavaDir\bin\java.exe")) {
    Write-Host "[INFO] Installing Microsoft OpenJDK 17..."
    $jdkUrl = "https://aka.ms/download-jdk/microsoft-jdk-17.0.11-windows-x64.zip"
    $zipPath = "$env:TEMP\jdk.zip"
    Invoke-WebRequest -Uri $jdkUrl -OutFile $zipPath -UseBasicParsing

    Expand-Archive -Force $zipPath -DestinationPath $BaseDir
    Remove-Item $zipPath -Force

    # ë²„ì „ë³„ í´ë” ì´ë¦„ ìžë™ ê°ì§€ í›„ jdk-17 ë¡œ í†µì¼
    $extracted = Get-ChildItem -Directory $BaseDir | Where-Object { $_.Name -like "jdk-17*" } | Select-Object -First 1
    if ($extracted -and $extracted.Name -ne "jdk-17") {
        Rename-Item -Path $extracted.FullName -NewName "jdk-17" -Force
    }
}

# JAVA_HOME ì„¤ì •
if (!(Test-Path "$JavaDir\bin\java.exe")) {
    Write-Host "âŒ JDK ì„¤ì¹˜ ì‹¤íŒ¨. ê²½ë¡œ í™•ì¸ í•„ìš”: $JavaDir"
    exit 1
}

$env:JAVA_HOME = $JavaDir
[Environment]::SetEnvironmentVariable("JAVA_HOME", $JavaDir, "Machine")
$env:Path += ";$JavaDir\bin"

# ====== 3. Android Commandline Tools ì„¤ì¹˜ ======
if (!(Test-Path "$ToolsDir\bin\sdkmanager.bat")) {
    Write-Host "[INFO] Installing Android Commandline Tools..."
    $sdkUrl = "https://dl.google.com/android/repository/commandlinetools-win-11076708_latest.zip"
    $zipSdk = "$env:TEMP\cmdtools.zip"
    Invoke-WebRequest -Uri $sdkUrl -OutFile $zipSdk -UseBasicParsing

    Expand-Archive -Force $zipSdk -DestinationPath "$SdkRoot\cmdline-tools"
    Rename-Item -Path "$SdkRoot\cmdline-tools\cmdline-tools" -NewName "latest"
    Remove-Item $zipSdk -Force
}

$env:ANDROID_SDK_ROOT = $SdkRoot
[Environment]::SetEnvironmentVariable("ANDROID_SDK_ROOT", $SdkRoot, "Machine")
$SdkBin     = "$ToolsDir\bin"
$EmulatorExe= "$SdkRoot\emulator\emulator.exe"
$AvdManager = "$SdkBin\avdmanager.bat"

# ====== 4. SDK íŒ¨í‚¤ì§€ ì„¤ì¹˜ ======
Write-Host "[INFO] Installing SDK components..."
& "$SdkBin\sdkmanager.bat" --sdk_root="$SdkRoot" --install "platform-tools" "emulator" | Out-Null

# ====== 5. System Image ì„¤ì¹˜ ======
$API = 30
$IMG = "system-images;android-$API;google_apis_playstore;x86_64"
Write-Host "[INFO] Installing system image: $IMG"
& "$SdkBin\sdkmanager.bat" --sdk_root="$SdkRoot" --install "$IMG" | Out-Null

# ====== 6. AVD ìƒì„± ======
if (!(Test-Path $AVD_PATH)) {
    Write-Host "[INFO] Creating AVD: $AVD_NAME"
    & $AvdManager create avd -n $AVD_NAME -k $IMG --device "pixel" --force | Out-Null
    Start-Sleep -Seconds 5
} else {
    Write-Host "[INFO] Existing AVD found: $AVD_NAME"
}

# AVD ìƒì„± ì—¬ë¶€ í™•ì¸
if (!(Test-Path $AVD_CONFIG)) {
    Write-Host "âŒ AVD ìƒì„± ì‹¤íŒ¨ ë˜ëŠ” config.ini ê²½ë¡œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
    Write-Host "   í™•ì¸ ê²½ë¡œ: $AVD_PATH"
    exit 1
}

# ====== 7. í•˜ë“œì›¨ì–´ í”„ë¡œí•„ ì ìš© ======
if (Test-Path $ProfileFile) {
    Write-Host "[INFO] Applying hardware profile from $ProfileFile"
    Get-Content $ProfileFile | Add-Content $AVD_CONFIG
} else {
    Write-Host "âš ï¸  í•˜ë“œì›¨ì–´ í”„ë¡œí•„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê¸°ë³¸ ì„¤ì •ìœ¼ë¡œ ì§„í–‰í•©ë‹ˆë‹¤."
}

# ====== 8. ì—ë®¬ë ˆì´í„° ì‹¤í–‰ ======
if (!(Test-Path $EmulatorExe)) {
    Write-Host "âŒ emulator.exeë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. SDK ì„¤ì¹˜ë¥¼ í™•ì¸í•˜ì„¸ìš”: $EmulatorExe"
    exit 1
}

Write-Host "[INFO] Launching emulator..."
Start-Process "$EmulatorExe" -ArgumentList "-avd", "$AVD_NAME", "-netdelay", "none", "-netspeed", "full", "-gpu", "host"
Write-Host "[SUCCESS] Emulator launched successfully ðŸš€"







#!/usr/bin/env pwsh
Set-StrictMode -Version Latest
$ErrorActionPreference = "Stop"

# ====== 0. ê´€ë¦¬ìž ê¶Œí•œ í™•ì¸ ======
if (-not ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {
    Write-Host "âš ï¸  ê´€ë¦¬ìž ê¶Œí•œìœ¼ë¡œ PowerShellì„ ë‹¤ì‹œ ì‹¤í–‰í•´ì£¼ì„¸ìš”."
    exit 1
}

# ====== 1. ê²½ë¡œ ì„¤ì • ======
$BaseDir = "$env:USERPROFILE\AndroidEnv"
$SdkRoot = "$BaseDir\sdk"
$ToolsDir = "$SdkRoot\cmdline-tools\latest"
$JavaDir = "$BaseDir\jdk-17"
$ProfileDir = "$PSScriptRoot\profiles"
$ProfileFile = Join-Path $ProfileDir "note20.ini"

# ====== 2. JDK ì„¤ì¹˜ (Microsoft OpenJDK 17) ======
if (!(Test-Path "$JavaDir\bin\java.exe")) {
    Write-Host "[INFO] JDK ì„¤ì¹˜ ì¤‘..."
    $jdkUrl = "https://aka.ms/download-jdk/microsoft-jdk-17.0.11-windows-x64.zip"
    $zipPath = "$env:TEMP\jdk.zip"
    Invoke-WebRequest -Uri $jdkUrl -OutFile $zipPath
    Expand-Archive -Force $zipPath -DestinationPath $BaseDir
    Rename-Item -Path "$BaseDir\jdk-17.0.11+9" -NewName "jdk-17" -ErrorAction SilentlyContinue
    Remove-Item $zipPath -Force
}
$env:JAVA_HOME = $JavaDir
$env:Path += ";$JavaDir\bin"

# ====== 3. Android Commandline Tools ì„¤ì¹˜ ======
if (!(Test-Path "$ToolsDir\bin\sdkmanager.bat")) {
    Write-Host "[INFO] Android commandline-tools ì„¤ì¹˜ ì¤‘..."
    $sdkUrl = "https://dl.google.com/android/repository/commandlinetools-win-11076708_latest.zip"
    $zipSdk = "$env:TEMP\cmdtools.zip"
    Invoke-WebRequest -Uri $sdkUrl -OutFile $zipSdk
    Expand-Archive -Force $zipSdk -DestinationPath "$SdkRoot\cmdline-tools"
    Rename-Item -Path "$SdkRoot\cmdline-tools\cmdline-tools" -NewName "latest"
    Remove-Item $zipSdk -Force
}

$env:ANDROID_SDK_ROOT = $SdkRoot
$SdkBin = "$ToolsDir\bin"
$EmulatorExe = "$SdkRoot\emulator\emulator.exe"

# ====== 4. SDK íŒ¨í‚¤ì§€ ì„¤ì¹˜ ======
Write-Host "[INFO] SDK íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì¤‘..."
& "$SdkBin\sdkmanager.bat" --sdk_root="$SdkRoot" --install "platform-tools" "emulator"

# ====== 5. System Image ì„¤ì¹˜ ======
$API = 30
$IMG = "system-images;android-$API;google_apis_playstore;x86_64"
& "$SdkBin\sdkmanager.bat" --sdk_root="$SdkRoot" --install "$IMG"

# ====== 6. AVD ìƒì„± ======
$AVD_NAME = "Galaxy_Note20_256GB"
$AVD_DIR = "$env:USERPROFILE\.android\avd"
$AVD_CONFIG = "$AVD_DIR\$AVD_NAME.avd\config.ini"
$AvdManager = "$SdkBin\avdmanager.bat"

if (!(Test-Path "$AVD_DIR\$AVD_NAME.avd")) {
    Write-Host "[INFO] Creating AVD: $AVD_NAME"
    & $AvdManager create avd -n $AVD_NAME -k $IMG --device "pixel" --force
} else {
    Write-Host "[INFO] Existing AVD detected: $AVD_NAME"
}

# ====== 7. í•˜ë“œì›¨ì–´ í”„ë¡œí•„ ì ìš© ======
if (Test-Path $ProfileFile) {
    Write-Host "[INFO] Applying hardware profile from $ProfileFile"
    Get-Content $ProfileFile | Add-Content $AVD_CONFIG
} else {
    Write-Host "âš ï¸  í•˜ë“œì›¨ì–´ í”„ë¡œí•„($ProfileFile)ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê¸°ë³¸ ì„¤ì •ìœ¼ë¡œ ì§„í–‰í•©ë‹ˆë‹¤."
}

# ====== 8. Emulator ì‹¤í–‰ ======
Write-Host "[INFO] Launching emulator..."
Start-Process "$EmulatorExe" -ArgumentList "-avd", "$AVD_NAME", "-netdelay", "none", "-netspeed", "full", "-gpu", "host"







if ! command -v java >/dev/null 2>&1; then
  echo "[INFO] JDKê°€ ì„¤ì¹˜ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤."
  read -p "OpenJDK 17ì„ ì„¤ì¹˜í• ê¹Œìš”? (y/n, ê¸°ë³¸ê°’ y): " install_jdk
  install_jdk=${install_jdk:-y}
  if [[ "$install_jdk" == "y" ]]; then
    if command -v apt >/dev/null 2>&1; then
      sudo apt update -y
      sudo apt install -y openjdk-17-jdk
    elif command -v dnf >/dev/null 2>&1; then
      sudo dnf install -y java-17-openjdk
    elif command -v brew >/dev/null 2>&1; then
      brew install openjdk@17
    elif [[ "$OS" == "Windows_NT" ]]; then
      echo "[INFO] Windows í™˜ê²½ ê°ì§€ë¨. Wingetìœ¼ë¡œ ì„¤ì¹˜í•©ë‹ˆë‹¤."
      winget install --id Microsoft.OpenJDK.17 -e || {
        echo "[ERROR] winget ì„¤ì¹˜ ì‹¤íŒ¨. https://learn.microsoft.com/en-us/java/openjdk/download ì—ì„œ ìˆ˜ë™ ì„¤ì¹˜ í•„ìš”."
        exit 1
      }
    else
      echo "[ERROR] íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ JDKë¥¼ ì„¤ì¹˜í•˜ì„¸ìš”."
      exit 1
    fi
  else
    echo "[ERROR] JDK ì—†ì´ ì§„í–‰ ë¶ˆê°€"
    exit 1
  fi
fi





#!/usr/bin/env pwsh
Set-StrictMode -Version Latest
$ErrorActionPreference = "Stop"

# ====== 1. ì„ íƒ UI ======
Write-Host "=== Galaxy Emulator Launcher ==="
Write-Host "1) Galaxy Note 10"
Write-Host "2) Galaxy Note 20"
Write-Host "3) Galaxy S22"
$CHOICE = Read-Host "Select device [1-3]"

switch ($CHOICE) {
    1 {
        $DEVICE = "note10"
        $API = 29
        $IMG = "system-images;android-$API;google_apis_playstore;x86_64"
        $AVD_NAME = "Galaxy_Note10_256GB"
    }
    2 {
        $DEVICE = "note20"
        $API = 30
        $IMG = "system-images;android-$API;google_apis_playstore;x86_64"
        $AVD_NAME = "Galaxy_Note20_256GB"
    }
    3 {
        $DEVICE = "s22"
        $API = 32
        $IMG = "system-images;android-$API;google_apis_playstore;x86_64"
        $AVD_NAME = "Galaxy_S22_256GB"
    }
    Default {
        Write-Host "âŒ Invalid selection" -ForegroundColor Red
        exit 1
    }
}

# ====== 2. í”„ë¡œí•„ íŒŒì¼ ì¡´ìž¬ í™•ì¸ ======
$PROFILE_PATH = ".\profiles\$DEVICE.ini"
if (!(Test-Path $PROFILE_PATH)) {
    Write-Host "âŒ Profile file not found: $PROFILE_PATH" -ForegroundColor Red
    exit 1
}

# ====== 3. SDK ì´ë¯¸ì§€ ì„¤ì¹˜ ======
Write-Host "[INFO] Installing required system image..."
& sdkmanager --install "$IMG"

# ====== 4. AVD ìƒì„± ======
Write-Host "[INFO] Creating AVD: $AVD_NAME"
& avdmanager create avd -n "$AVD_NAME" -k "$IMG" --device "pixel" --force

# AVD ì„¤ì • íŒŒì¼ ê²½ë¡œ
$AVD_PATH = "$env:USERPROFILE\.android\avd\$AVD_NAME.avd\config.ini"

# ====== 5. í•˜ë“œì›¨ì–´ í”„ë¡œí•„ ì ìš© ======
Write-Host "[INFO] Applying hardware profile from $PROFILE_PATH"
Get-Content $PROFILE_PATH | Add-Content $AVD_PATH

# ====== 6. ì—ë®¬ë ˆì´í„° ì‹¤í–‰ ======
Write-Host "[INFO] Launching emulator..."
Start-Process "emulator" -ArgumentList "-avd", "$AVD_NAME", "-netdelay", "none", "-netspeed", "full", "-gpu", "host"







# ---------------------------------------------------------
# (6.5) ìŠ¤í‚¨ í´ë”ë¥¼ SDK ê²½ë¡œë¡œ ë³µì‚¬
# ---------------------------------------------------------
echo "[INFO] SDK ê²½ë¡œë¡œ ìŠ¤í‚¨ í´ë” ë³µì‚¬ ì¤‘..."

SRC_SKINS_DIR="$SCRIPT_DIR/skins"
DEST_SKINS_DIR="$SDK_ROOT/skins"

# SDK ë‚´ë¶€ skins í´ë”ê°€ ì—†ìœ¼ë©´ ìƒì„±
mkdir -p "$DEST_SKINS_DIR"

# ì‚¬ìš©ìž ìŠ¤í‚¨ í´ë” ì „ì²´ë¥¼ ë³µì‚¬ (ê¸°ì¡´ íŒŒì¼ ë®ì–´ì“°ê¸°)
if [ -d "$SRC_SKINS_DIR" ]; then
  echo "[INFO] $SRC_SKINS_DIR â†’ $DEST_SKINS_DIR ë³µì‚¬"
  cp -r "$SRC_SKINS_DIR"/* "$DEST_SKINS_DIR"/
  echo "[OK] ìŠ¤í‚¨ ë³µì‚¬ ì™„ë£Œ."
else
  echo "[WARN] $SRC_SKINS_DIR í´ë”ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìŠ¤í‚¨ ë³µì‚¬ëŠ” ìƒëžµë©ë‹ˆë‹¤."
fi

# ì´ì œ config.iniì—ì„œ ì ˆëŒ€ê²½ë¡œ ëŒ€ì‹  ì´ë¦„ë§Œ ì¨ë„ ì¸ì‹ë¨



takeown /f "$env:USERPROFILE\.android" /r /d y
icacls "$env:USERPROFILE\.android" /grant "${env:USERNAME}:(OI)(CI)F" /t




# --- Fix Samsung skin path automatically ---
AVD_PATH="$HOME/.android/avd/${AVD_NAME}.avd"
SKIN_ABS_PATH="$(cd "$SKIN_DIR"; pwd)"
echo "[INFO] ìŠ¤í‚¨ ê²½ë¡œ ë³´ì • ì¤‘: $SKIN_ABS_PATH"

# ê¸°ì¡´ skin.name, skin.path ì œê±° í›„ ë‹¤ì‹œ ê¸°ë¡
grep -v '^skin\.' "$AVD_PATH/config.ini" > "$AVD_PATH/config.tmp" || true
mv "$AVD_PATH/config.tmp" "$AVD_PATH/config.ini"

cat >> "$AVD_PATH/config.ini" <<EOF
skin.name=$(basename "$SKIN_ABS_PATH")
skin.path=$SKIN_ABS_PATH
EOF




#!/usr/bin/env bash
set -e

# ========================================
# Android Emulator Full Setup (bash version)
# ========================================

SDK_ROOT="$HOME/android-sdk"
CMDLINE_URL="https://dl.google.com/android/repository/commandlinetools-linux-11076708_latest.zip"
AVD_NAME="custom_avd"
JDK_PATH=""

echo "====================================="
echo "   Android Emulator Auto Setup"
echo "====================================="

# ---------------------------------------------------------
# (1) JDK ì„¤ì¹˜ í™•ì¸ ë° ê²½ë¡œ ì„¤ì •
# ---------------------------------------------------------
if ! command -v java >/dev/null 2>&1; then
  echo "[INFO] JDKê°€ ì„¤ì¹˜ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤."
  read -p "OpenJDK 17ì„ ì„¤ì¹˜í• ê¹Œìš”? (y/n, ê¸°ë³¸ê°’ y): " install_jdk
  install_jdk=${install_jdk:-y}
  if [[ "$install_jdk" == "y" ]]; then
    if command -v apt >/dev/null 2>&1; then
      sudo apt update -y
      sudo apt install -y openjdk-17-jdk
    elif command -v dnf >/dev/null 2>&1; then
      sudo dnf install -y java-17-openjdk
    elif command -v brew >/dev/null 2>&1; then
      brew install openjdk@17
    else
      echo "[ERROR] íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ JDKë¥¼ ì„¤ì¹˜í•˜ì„¸ìš”."
      exit 1
    fi
  else
    echo "[ERROR] JDK ì—†ì´ ì§„í–‰ ë¶ˆê°€"
    exit 1
  fi
fi

# JDK ê²½ë¡œ ìžë™ íƒìƒ‰
JDK_PATH=$(dirname "$(dirname "$(readlink -f "$(which java)")")")
if [[ -z "$JDK_PATH" || ! -d "$JDK_PATH" ]]; then
  echo "[WARN] JDK ì„¤ì¹˜ ê²½ë¡œë¥¼ ìžë™ìœ¼ë¡œ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. JAVA_HOMEì„ ìˆ˜ë™ ì§€ì •í•˜ì„¸ìš”."
  read -p "JAVA_HOME ê²½ë¡œ ìž…ë ¥ (ì˜ˆ: /usr/lib/jvm/java-17-openjdk-amd64): " manual_jdk
  export JAVA_HOME="${manual_jdk}"
else
  export JAVA_HOME="$JDK_PATH"
fi

export PATH="$JAVA_HOME/bin:$PATH"

java -version || { echo "[ERROR] java ëª…ë ¹ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."; exit 1; }

echo "[OK] JAVA_HOME=$JAVA_HOME"

# ---------------------------------------------------------
# (2) Android SDK Commandline Tools ì„¤ì¹˜
# ---------------------------------------------------------
if [ ! -d "$SDK_ROOT" ]; then
  echo "[INFO] Android SDK Commandline Toolsë¥¼ ë‹¤ìš´ë¡œë“œ ì¤‘..."
  mkdir -p "$SDK_ROOT/cmdline-tools"
  cd "$SDK_ROOT"
  curl -L -o cmdline-tools.zip "$CMDLINE_URL"
  unzip -q cmdline-tools.zip -d cmdline-tools
  mv cmdline-tools/cmdline-tools cmdline-tools/latest
  rm cmdline-tools.zip
fi

export ANDROID_HOME="$SDK_ROOT"
export ANDROID_SDK_ROOT="$SDK_ROOT"
export PATH="$ANDROID_HOME/cmdline-tools/latest/bin:$ANDROID_HOME/emulator:$ANDROID_HOME/platform-tools:$PATH"

# ---------------------------------------------------------
# (3) SDK êµ¬ì„±ìš”ì†Œ ì„¤ì¹˜ (HTTPS ì°¨ë‹¨ ì‹œ no_https ì‚¬ìš©)
# ---------------------------------------------------------
echo "[INFO] SDK êµ¬ì„±ìš”ì†Œ ì„¤ì¹˜ ì¤‘..."
mkdir -p "$HOME/.android"
touch "$HOME/.android/repositories.cfg"

# í´ë” êµ¬ì¡° ìžë™ êµì •
if [ -d "$ANDROID_HOME/cmdline-tools/cmdline-tools" ]; then
  mv "$ANDROID_HOME/cmdline-tools/cmdline-tools" "$ANDROID_HOME/cmdline-tools/latest"
fi

SDKMANAGER="$ANDROID_HOME/cmdline-tools/latest/bin/sdkmanager"

# HTTPS ìš°íšŒ ëª¨ë“œ
$SDKMANAGER --no_https --licenses >/dev/null || true
$SDKMANAGER --no_https "platform-tools" "emulator"

# ---------------------------------------------------------
# (4) Android ì‹œìŠ¤í…œ ì´ë¯¸ì§€ ì„ íƒ ë° ì„¤ì¹˜
# ---------------------------------------------------------
echo
echo "ì–´ë–¤ ì•ˆë“œë¡œì´ë“œ ì‹œìŠ¤í…œ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í• ê¹Œìš”?"
echo "1) Android 13 (Google APIs)"
echo "2) Android 14 (Google Play)"
read -p "ë²ˆí˜¸ ìž…ë ¥ (ê¸°ë³¸ê°’ 2): " sys_choice
sys_choice=${sys_choice:-2}

if [[ "$sys_choice" == "1" ]]; then
  SYS_IMG="system-images;android-33;google_apis;x86_64"
else
  SYS_IMG="system-images;android-34;google_apis_playstore;x86_64"
fi

$SDKMANAGER --no_https "$SYS_IMG"

# ---------------------------------------------------------
# (5) ìŠ¤í‚¨ ì„ íƒ (ë¡œì»¬ skins/ í´ë”ì—ì„œ)
# ---------------------------------------------------------
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
echo
echo "ì–´ë–¤ í•˜ë“œì›¨ì–´ë¥¼ AVDë¡œ ìƒì„±í• ê¹Œìš”?"
echo "1) Samsung Galaxy Note20"
echo "2) Samsung Galaxy S22"
echo "3) Samsung Galaxy S24 Ultra"
read -p "ë²ˆí˜¸ ìž…ë ¥ (ê¸°ë³¸ê°’ 2): " hw_choice
hw_choice=${hw_choice:-2}

case $hw_choice in
  1) HW_NAME="Galaxy_Note20" ;;
  2) HW_NAME="Galaxy_S22" ;;
  3) HW_NAME="Galaxy_S24Ultra" ;;
esac

SKIN_DIR="$SCRIPT_DIR/skins/$HW_NAME"
if [ ! -d "$SKIN_DIR" ]; then
  echo "[ERROR] ìŠ¤í‚¨ í´ë”ê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤: $SKIN_DIR"
  exit 1
fi
echo "[INFO] ìŠ¤í‚¨ ê²½ë¡œ ì¸ì‹ ì™„ë£Œ: $SKIN_DIR"

# ---------------------------------------------------------
# (6) RAM / ìŠ¤í† ë¦¬ì§€ ì„¤ì •
# ---------------------------------------------------------
read -p "RAM í¬ê¸°(MB) [ê¸°ë³¸ê°’ 4096]: " RAM_SIZE
RAM_SIZE=${RAM_SIZE:-4096}
read -p "ìŠ¤í† ë¦¬ì§€ í¬ê¸°(MB) [ê¸°ë³¸ê°’ 8192]: " STORAGE_SIZE
STORAGE_SIZE=${STORAGE_SIZE:-8192}

# ---------------------------------------------------------
# (7) AVD ìƒì„±
# ---------------------------------------------------------
echo "[INFO] AVD ìƒì„± ì¤‘..."
yes "no" | avdmanager create avd \
  -n "$AVD_NAME" \
  -k "$SYS_IMG" \
  -d pixel_6 \
  --sdcard "${STORAGE_SIZE}M" \
  --force

AVD_PATH="$HOME/.android/avd/${AVD_NAME}.avd"
cat >> "$AVD_PATH/config.ini" <<EOF
hw.ramSize=$RAM_SIZE
skin.name=$HW_NAME
skin.path=$SKIN_DIR
EOF

# ---------------------------------------------------------
# (8) ì—ë®¬ë ˆì´í„° ì‹¤í–‰
# ---------------------------------------------------------
echo "[INFO] ì—ë®¬ë ˆì´í„°ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤..."
emulator -avd "$AVD_NAME" -netdelay none -netspeed full &







::::::::::::
#!/usr/bin/env bash

set -e

# ============================
# ê¸°ë³¸ ì„¤ì •
# ============================
SDK_ROOT="$HOME/android-sdk"
CMDLINE_URL="https://dl.google.com/android/repository/commandlinetools-linux-11076708_latest.zip"
AVD_NAME="custom_avd"

echo "====================================="
echo "  Android Emulator Setup Wizard"
echo "====================================="

# ============================
# (1) JDK ì„¤ì¹˜ ì—¬ë¶€ í™•ì¸
# ============================
if ! command -v java >/dev/null 2>&1; then
  echo "[INFO] JDKê°€ ì„¤ì¹˜ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤."
  read -p "OpenJDK 17ì„ ì„¤ì¹˜í• ê¹Œìš”? (y/n): " install_jdk
  if [[ "$install_jdk" == "y" ]]; then
    sudo apt update -y
    sudo apt install -y openjdk-17-jdk
  else
    echo "JDK ì„¤ì¹˜ ì—†ì´ ì§„í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì¢…ë£Œí•©ë‹ˆë‹¤."
    exit 1
  fi
else
  echo "[OK] JDKê°€ ì´ë¯¸ ì„¤ì¹˜ë˜ì–´ ìžˆìŠµë‹ˆë‹¤."
fi

# ============================
# (2) SDK / ëª…ë ¹ì¤„ ë„êµ¬ ì„¤ì¹˜
# ============================
if [ ! -d "$SDK_ROOT" ]; then
  echo "[INFO] Android SDKë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤..."
  mkdir -p "$SDK_ROOT/cmdline-tools"
  cd "$SDK_ROOT"
  curl -o cmdline-tools.zip $CMDLINE_URL
  unzip cmdline-tools.zip -d cmdline-tools
  mv cmdline-tools/cmdline-tools cmdline-tools/latest
  rm cmdline-tools.zip
fi

export ANDROID_HOME="$SDK_ROOT"
export PATH="$ANDROID_HOME/emulator:$ANDROID_HOME/tools:$ANDROID_HOME/tools/bin:$ANDROID_HOME/platform-tools:$ANDROID_HOME/cmdline-tools/latest/bin:$PATH"

# ============================
# SDK íŒ¨í‚¤ì§€ ì„¤ì¹˜
# ============================
echo "[INFO] SDK êµ¬ì„±ìš”ì†Œë¥¼ ì—…ë°ì´íŠ¸ ì¤‘..."
yes | sdkmanager --licenses >/dev/null || true
yes | sdkmanager "platform-tools" "emulator" >/dev/null

# ============================
# (3) í•˜ë“œì›¨ì–´ ê¸°ê¸° ì„ íƒ
# ============================
echo
echo "ì–´ë–¤ í•˜ë“œì›¨ì–´ë¥¼ AVDë¡œ ìƒì„±í• ê¹Œìš”?"
echo "1) Samsung Galaxy Note20"
echo "2) Samsung Galaxy S22"
echo "3) Samsung Galaxy S24 Ultra"
read -p "ë²ˆí˜¸ë¥¼ ìž…ë ¥í•˜ì„¸ìš” (1~3): " hw_choice

case $hw_choice in
  1) HW_NAME="Galaxy_Note20"; SKIN_URL="https://developer.samsung.com/android/tools/emulator-skins/Note20.zip" ;;
  2) HW_NAME="Galaxy_S22"; SKIN_URL="https://developer.samsung.com/android/tools/emulator-skins/S22.zip" ;;
  3) HW_NAME="Galaxy_S24Ultra"; SKIN_URL="https://developer.samsung.com/android/tools/emulator-skins/S24Ultra.zip" ;;
  *) echo "ìž˜ëª»ëœ ì„ íƒìž…ë‹ˆë‹¤."; exit 1 ;;
esac

SKIN_DIR="$ANDROID_HOME/skins/$HW_NAME"
mkdir -p "$SKIN_DIR"
echo "[INFO] ì‚¼ì„± ìŠ¤í‚¨ ë‹¤ìš´ë¡œë“œ ì¤‘..."
curl -L -o "$SDK_ROOT/${HW_NAME}.zip" "$SKIN_URL"
unzip -o "$SDK_ROOT/${HW_NAME}.zip" -d "$SKIN_DIR"
rm "$SDK_ROOT/${HW_NAME}.zip"

# ============================
# (4) ì‹œìŠ¤í…œ ì´ë¯¸ì§€ ì„ íƒ
# ============================
echo
echo "ì–´ë–¤ ì•ˆë“œë¡œì´ë“œ ì‹œìŠ¤í…œ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í• ê¹Œìš”?"
echo "1) Android 13 (Google APIs)"
echo "2) Android 14 (Google Play)"
read -p "ë²ˆí˜¸ë¥¼ ìž…ë ¥í•˜ì„¸ìš” (1~2): " sys_choice

case $sys_choice in
  1) SYS_IMG="system-images;android-33;google_apis;x86_64" ;;
  2) SYS_IMG="system-images;android-34;google_apis_playstore;x86_64" ;;
  *) echo "ìž˜ëª»ëœ ì„ íƒìž…ë‹ˆë‹¤."; exit 1 ;;
esac

echo "[INFO] ì‹œìŠ¤í…œ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ì¤‘..."
yes | sdkmanager "$SYS_IMG"

# ============================
# (5) í•˜ë“œì›¨ì–´ í”„ë¡œí•„ ì„¤ì •
# ============================
read -p "RAM í¬ê¸°(MB): " RAM_SIZE
read -p "ìŠ¤í† ë¦¬ì§€ í¬ê¸°(MB): " STORAGE_SIZE

# ============================
# (6) AVD ìƒì„±
# ============================
echo "[INFO] AVDë¥¼ ìƒì„± ì¤‘..."
echo no | avdmanager create avd \
  -n "$AVD_NAME" \
  -k "$SYS_IMG" \
  -d pixel_6 \
  --sdcard "${STORAGE_SIZE}M" \
  --force

# config.ini ìˆ˜ì •
AVD_PATH="$HOME/.android/avd/${AVD_NAME}.avd"
cat >> "$AVD_PATH/config.ini" <<EOF
hw.ramSize=$RAM_SIZE
skin.name=$HW_NAME
skin.path=$SKIN_DIR
EOF

# ============================
# (7) ì—ë®¬ë ˆì´í„° ì‹¤í–‰
# ============================
echo "[INFO] ì—ë®¬ë ˆì´í„°ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤..."
emulator -avd "$AVD_NAME" -netdelay none -netspeed full &
